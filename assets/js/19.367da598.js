(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{339:function(t,e,a){"use strict";a.r(e);var s=a(3),n=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"设置数据库配置文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#设置数据库配置文件"}},[t._v("#")]),t._v(" 设置数据库配置文件")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),e("p",[t._v("有时候你可以不止使用一个数据库，此时需要重新指定数据库配置，具体演示可以参考"),e("code",[t._v("Model")]),t._v("类的"),e("a",{attrs:{href:"#model-setdb"}},[e("code",[t._v("setDb")])]),t._v("函数。")])]),t._v(" "),e("h3",{attrs:{id:"model-setdblocation"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#model-setdblocation"}},[t._v("#")]),t._v(" Model::setDbLocation")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("设置数据库配置文件位置")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("参数名")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("类型")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("$path")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("string")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("文件位置")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("$name")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("string")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("文件名")])])])]),t._v(" "),e("h3",{attrs:{id:"model-setdatabase"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#model-setdatabase"}},[t._v("#")]),t._v(" Model::setDatabase")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("设置数据库配置文件中的配置名称")]),t._v(" "),e("p",[t._v("一个数据库配置文件可以存放多个数据库配置，指定配置名才能定位到准确的数据库")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("参数名")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("类型")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("$dbName")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("string")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("配置文件名")])])])]),t._v(" "),e("h3",{attrs:{id:"model-setdb"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#model-setdb"}},[t._v("#")]),t._v(" Model::setDb")]),t._v(" "),e("p",[t._v("这个函数会在创建数据库类的时候调用，你可以在继承Model类后重写该方法，设置数据库配置文件。")]),t._v(" "),e("h2",{attrs:{id:"导入导出数据库数据"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#导入导出数据库数据"}},[t._v("#")]),t._v(" 导入导出数据库数据")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),e("p",[t._v("CleanPHP配置了导入导出数据库功能，可以非常方便的导入或者导出sql文件")])]),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),e("p",[t._v("该功能需要先配置数据库信息才能使用。\n如果你的数据库地址不在默认位置，你需要先"),e("a",{attrs:{href:"#%E8%AE%BE%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"}},[t._v("设置数据库配置文件")])])]),t._v(" "),e("p",[e("strong",[t._v("使用演示")])]),t._v(" "),e("div",{staticClass:"language-php line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[t._v("  "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$model")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Model")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// $this->setDbLocation(APP_CONF,"db")->setDatabase("master");')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 数据库不在默认位置才需要设置上述内容")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//导入数据库")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$model")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("import")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("APP_STORAGE")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"/sql/base.sql"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//导出数据库")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$model")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("export")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("APP_STORAGE")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"/sql/output.sql"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br")])]),e("h3",{attrs:{id:"model-import"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#model-import"}},[t._v("#")]),t._v(" Model::import")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("导入数据库")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("参数名")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("类型")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("$sqlPath")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("string")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("导入的sql文件地址")])])])]),t._v(" "),e("h3",{attrs:{id:"model-export"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#model-export"}},[t._v("#")]),t._v(" Model::export")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("导出数据库")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("参数名")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("类型")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("$output")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("string")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("导出的sql文件地址，包含文件名")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("$onlyStruct")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("boolean")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("是否只导出数据库结构")])])])]),t._v(" "),e("h2",{attrs:{id:"执行sql语句"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#执行sql语句"}},[t._v("#")]),t._v(" 执行SQL语句")]),t._v(" "),e("div",{staticClass:"custom-block danger"},[e("p",{staticClass:"custom-block-title"},[t._v("警告")]),t._v(" "),e("p",[t._v("如果您不确定您的sql语句是否安全，请不要直接使用该方法执行语句，这非常危险。")]),t._v(" "),e("p",[t._v("我们建议使用"),e("RouterLink",{attrs:{to:"/00.开发文档/04.数据库模型/04.SQL语句构造器.html"}},[t._v("SQL语句构造器")]),t._v("来执行SQL语句。")],1)]),t._v(" "),e("h3",{attrs:{id:"model-execute"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#model-execute"}},[t._v("#")]),t._v(" Model::execute")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("执行SQL语句")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("参数名")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("类型")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("$sql")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("string")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("需要执行的SQL语句")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("$params")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("array")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("需要绑定的参数")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("$readonly")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("boolean")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("是否为查询模式")])])])]),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),e("p",[e("code",[t._v("$readonly")]),t._v("的值如果为"),e("code",[t._v("false")]),t._v("，则返回影响行数或者唯一id的值。")]),t._v(" "),e("p",[t._v("反之，返回的查询的记录数组。")])]),t._v(" "),e("h2",{attrs:{id:"事务支持"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#事务支持"}},[t._v("#")]),t._v(" 事务支持")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),e("p",[t._v("事务主要用于处理操作量大，复杂度高的数据。")])]),t._v(" "),e("h3",{attrs:{id:"model-begintransaction"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#model-begintransaction"}},[t._v("#")]),t._v(" Model::beginTransaction")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("事务开始")])]),t._v(" "),e("h3",{attrs:{id:"model-rollback"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#model-rollback"}},[t._v("#")]),t._v(" Model::rollBack")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("事务回滚")])]),t._v(" "),e("h3",{attrs:{id:"model-commit"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#model-commit"}},[t._v("#")]),t._v(" Model::commit")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("事务提交")])]),t._v(" "),e("h2",{attrs:{id:"其他函数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#其他函数"}},[t._v("#")]),t._v(" 其他函数")]),t._v(" "),e("h3",{attrs:{id:"model-getpage"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#model-getpage"}},[t._v("#")]),t._v(" Model::getPage")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("获取Select语句获得分页数据对象")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("函数")]),t._v(" "),e("th",[t._v("含义")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("getTotalCount")]),t._v(" "),e("td",[t._v("符合条件的总记录数量")])]),t._v(" "),e("tr",[e("td",[t._v("getPageSize")]),t._v(" "),e("td",[t._v("每页多少条件记录")])]),t._v(" "),e("tr",[e("td",[t._v("getTotalPage")]),t._v(" "),e("td",[t._v("总共有多少页")])]),t._v(" "),e("tr",[e("td",[t._v("getFirstPage")]),t._v(" "),e("td",[t._v("第一页页码")])]),t._v(" "),e("tr",[e("td",[t._v("getPrevPage")]),t._v(" "),e("td",[t._v("上一页页码")])]),t._v(" "),e("tr",[e("td",[t._v("getNextPage")]),t._v(" "),e("td",[t._v("下一页页码")])]),t._v(" "),e("tr",[e("td",[t._v("getLastPage")]),t._v(" "),e("td",[t._v("最后一页页码")])]),t._v(" "),e("tr",[e("td",[t._v("getCurrentPage")]),t._v(" "),e("td",[t._v("当前页页码")])]),t._v(" "),e("tr",[e("td",[t._v("getAllPages")]),t._v(" "),e("td",[t._v("全部页码数组")])]),t._v(" "),e("tr",[e("td",[t._v("getOffset")]),t._v(" "),e("td",[t._v("查询位移")])]),t._v(" "),e("tr",[e("td",[t._v("getLimit")]),t._v(" "),e("td",[t._v("查询条数")])])])]),t._v(" "),e("h3",{attrs:{id:"model-setoption"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#model-setoption"}},[t._v("#")]),t._v(" Model::setOption")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("修改某个记录的某个字段")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("参数名")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("类型")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("$idName")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("string")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("这个记录的唯一字段名称")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("$id")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("string")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("这个记录的唯一字段名称的值")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("$opt")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("string")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("需要修改的字段名称")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("$val")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("string")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("需要修改的字段的值")])])])]),t._v(" "),e("p",[t._v("举个例子：")]),t._v(" "),e("blockquote",[e("p",[t._v("需要修改"),e("code",[t._v("id")]),t._v("为"),e("code",[t._v("1")]),t._v("的记录，修改的字段为"),e("code",[t._v("name")]),t._v("，修改的值为"),e("code",[t._v("hello")]),t._v(".")])]),t._v(" "),e("div",{staticClass:"language-php line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("setOption")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"id"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"name"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"hello"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("h3",{attrs:{id:"model-emptytable"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#model-emptytable"}},[t._v("#")]),t._v(" Model::emptyTable")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("清空某个数据表")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("参数名")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("类型")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("$table_name")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("string")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("需要清空的表名")])])])]),t._v(" "),e("p",[t._v("举个例子：")]),t._v(" "),e("blockquote",[e("p",[t._v("需要修改"),e("code",[t._v("id")]),t._v("为"),e("code",[t._v("1")]),t._v("的记录，修改的字段为"),e("code",[t._v("name")]),t._v("，修改的值为"),e("code",[t._v("hello")]),t._v(".")])]),t._v(" "),e("div",{staticClass:"language-php line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("setOption")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"id"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"name"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"hello"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])])])}),[],!1,null,null,null);e.default=n.exports}}]);